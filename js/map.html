<body>
    <!-- 지도 담을 영역 만들기 -->
    <div id="map" style="width:500px;height:400px;"></div>
    <!-- 지도 그리는 API 불러오기 -->
    <script type="text/javascript"
        src="//dapi.kakao.com/v2/maps/sdk.js?appkey=da146a2a6ff6a54903c1d2a7caecd1c7"></script>


    <script>

        // 지도 중심 변경
        navigator.geolocation.getCurrentPosition(callback)

        function callback(pos) {
            let lat = pos.coords.latitude
            let lng = pos.coords.longitude
            console.log(`위치 확인 완료`, lat, lng)
            console.log(`지도 생성 전`);
            makeMap(lat, lng)
        }

        // 위치 확인이 지도 생성 전 보다 늦게 확인됨


        function makeMap(lat, lng) {


            const data = [
                { "name": "신비의 도로(도깨비 도로)", "lat": 33.4511642, "lng": 126.4856195 },
                { "name": "마라도", "lat": 33.1206363, "lng": 126.2583656 },
                { "name": "용머리해안", "lat": 33.231847, "lng": 126.3124523 },
                { "name": "안동대학교", "lat": 36.5426215, "lng": 128.7951168 },
                { "name": "대전복합터미널", "lat": 36.3516567, "lng": 127.4352227 },
                { "name": "대전역", "lat": 36.332326, "lng": 127.4320223 },
                { "name": "고려대학교 세종캠퍼스", "lat": 36.6093251, "lng": 127.2853982 },
                { "name": "조치원역", "lat": 36.6011107, "lng": 127.2941359 },
                { "name": "단국대학교 천안캠퍼스", "lat": 36.8375793, "lng": 127.1668739 },
                { "name": "동탄역", "lat": 37.199327, "lng": 127.094829 },
                { "name": "에버랜드", "lat": 37.2908718, "lng": 127.1933947 },
                { "name": "용천초등학교", "lat": 37.1921118, "lng": 127.2079101 },
                { "name": "부산대학교", "lat": 35.2322427971605, "lng": 129.08382445362 },
                { "name": "다대포 꿈의 낙조분수", "lat": 35.0463817180617, "lng": 128.968006805962 },
                { "name": "광안리 해수욕장", "lat": 35.1537727634193, "lng": 129.118519972498 },
                { "name": "해운대 달맞이길", "lat": 35.1576814559193, "lng": 129.182542912786 },
                { "name": "감천문화마을", "lat": 35.0974881365854, "lng": 129.010608479318 },
                { "name": "김해공항", "lat": 35.1728739832702, "lng": 128.945800032246 },
                { "name": "낙동강하굿둑전망대입구", "lat": 35.1095371420277, "lng": 128.948519178541 },
                { "name": "부산역", "lat": 35.117605126596, "lng": 129.045060216345 },
                { "name": "태종대", "lat": 35.0596949578329, "lng": 129.079805736256 },
                { "name": "해동용궁사", "lat": 35.1882392674714, "lng": 129.223245860198 },
                { "name": "스포원파크 금정체육공원", "lat": 35.289121735171, "lng": 129.107042158715 },
                { "name": "용인공용터미널", "lat": 37.232692, "lng": 127.209744 },
                { "name": "용인중앙시장", "lat": 37.235706, "lng": 127.206100 },
                { "name": "수원화성", "lat": 37.286734, "lng": 127.011478 },
                { "name": "보라매공원", "lat": 37.491943, "lng": 126.918722 },
                { "name": "숭실대학교", "lat": 37.495980, "lng": 126.956244 },
                { "name": "국립현충원", "lat": 37.499720, "lng": 126.972307 },
                { "name": "롯데월드", "lat": 37.510725, "lng": 127.098301 },
                { "name": "한양대학교", "lat": 37.556970, "lng": 127.045391 },
                { "name": "서울대학교", "lat": 37.457907, "lng": 126.951590 },
                { "name": "경복궁", "lat": 37.579070, "lng": 126.976951 },
                { "name": "연세대학교", "lat": 37.565458, "lng": 126.937997 },
                { "name": "김포국제공항", "lat": 37.557449, "lng": 126.794710 },
                { "name": "인천국제공항", "lat": 37.453769, "lng": 126.440242 },
                { "name": "하조대", "lat": 38.020442, "lng": 128.734616 },
                { "name": "경포대", "lat": 37.795198, "lng": 128.894448 }
            ];

            // 카카오 지도 가져오기
            var container = document.getElementById('map');
            var options = {
                center: new kakao.maps.LatLng(lat, lng),
                level: 3
            };


            var map = new kakao.maps.Map(container, options);

            // 마커 이미지 바꾸기

            var imageSrc = 'http://ggoreb.com/marker.png'
            var imageSize = new kakao.maps.Size(64, 69)
            var imageOption = { offset: new kakao.maps.Point(27, 69) }
            var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption)




            // 함수로 마커 생성하기
            for (let i = 0; i < data.length; i++) {

                // 마커 생성하기
                var markerPosition = new kakao.maps.LatLng(data[i]['lat'], data[i]['lng']);
                var marker = new kakao.maps.Marker({
                    position: markerPosition,

                    image: markerImage 
                    // 마커 이미지 바꾸기
                });

                marker.setMap(map);
            }

        }



    </script>
</body>